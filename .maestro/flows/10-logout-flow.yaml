appId: app.lizzie
name: "[Auth] - Logout Flow"
tags:
  - regression
  - auth
---
# =====================================================
# 로그아웃 플로우 테스트
# 설정 → 로그아웃 → 확인 → 로그인 화면 복귀
# =====================================================

# 앱 시작
- stopApp

- launchApp:
    clearState: false

# 애니메이션 완료 대기
- waitForAnimationToEnd:
    timeout: 5000

# =====================================================
# 1. 로그인 (필요 시)
# =====================================================

- tapOn:
    id: "login-mock-button"
    optional: true

- waitForAnimationToEnd:
    timeout: 5000

# =====================================================
# 2. 홈 화면에서 설정 진입
# =====================================================

- assertVisible:
    id: "home-screen"

# 스크린샷 - 로그아웃 전 홈
- takeScreenshot: "10-before-logout-home"

# 설정 버튼 탭
- assertVisible:
    id: "settings-button"

- tapOn:
    id: "settings-button"

- waitForAnimationToEnd:
    timeout: 3000

# =====================================================
# 3. 설정 화면 확인
# =====================================================

# NOTE: SettingsScreen에 testID 추가 권장 (settings-screen)
# 현재는 텍스트 기반 확인

- assertVisible:
    text: "도마뱀 정보"

- assertVisible:
    text: "계정"

- assertVisible:
    text: "로그아웃"

# 도마뱀 프로필 확인
- assertVisible:
    text: "리치"

# 스크린샷 - 설정 화면
- takeScreenshot: "10-settings-screen"

# =====================================================
# 4. 로그아웃 버튼 탭
# =====================================================

- tapOn:
    text: "로그아웃"

- waitForAnimationToEnd:
    timeout: 2000

# =====================================================
# 5. 로그아웃 확인 Alert 처리
# =====================================================

# Alert 확인
- assertVisible:
    text: "로그아웃"

- assertVisible:
    text: "정말 로그아웃하시겠어요?"

# 스크린샷 - 확인 Alert
- takeScreenshot: "10-logout-alert"

# 로그아웃 확인 버튼 탭
- tapOn:
    text: "로그아웃"

# 로그아웃 처리 대기
- waitForAnimationToEnd:
    timeout: 5000

# =====================================================
# 6. 로그인 화면 복귀 확인
# =====================================================

- assertVisible:
    id: "login-screen"

- assertVisible:
    id: "login-logo"

- assertVisible:
    id: "login-title"

- assertVisible:
    text: "꼬물톡"

- assertVisible:
    id: "login-google-button"

# Mock 로그인 버튼 확인 (개발 환경)
- assertVisible:
    id: "login-mock-button"

# 스크린샷 - 로그아웃 후 로그인 화면
- takeScreenshot: "10-after-logout"

# =====================================================
# 7. 재로그인 테스트 (선택)
# =====================================================

# Mock 로그인 다시 수행
- tapOn:
    id: "login-mock-button"

- waitForAnimationToEnd:
    timeout: 5000

# 홈 화면 복귀 확인
- assertVisible:
    id: "home-screen"

# 도마뱀 프로필 복원 확인
- assertVisible:
    text: "리치"

# 스크린샷 - 재로그인 후
- takeScreenshot: "10-after-relogin"

# =====================================================
# NOTE: 로그아웃 동작
# =====================================================
# 1. Zustand authStore의 signOut() 호출
# 2. AsyncStorage에서 세션 정보 삭제
# 3. TanStack Query 캐시 유지 여부는 구현에 따라 다름
# 4. Expo Router로 /login으로 replace
# 5. 재로그인 시 기존 도마뱀 정보 유지 (서버에서 조회)

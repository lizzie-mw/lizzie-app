# 🦎 Lizzie (리지) - 서비스 기획/정책 문서

> **문서 버전**: v1.0  
> **최종 수정일**: 2025-01-09  
> **작성자**: 명근, Wendy

---

## 1. 서비스 개요

### 1.1 서비스명
**Lizzie (리지)**

### 1.2 한 줄 소개
내가 키우는 도마뱀과 직접 대화하며 케어 정보를 배우는 AI 채팅 서비스

### 1.3 핵심 가치
| 가치 | 설명 |
|------|------|
| **관계성** | 단순 정보 전달이 아닌, 도마뱀 캐릭터와의 정서적 유대감 형성 |
| **교육** | 도마뱀 행동/환경 해석법을 대화 속에서 자연스럽게 학습 |
| **접근성** | AI 프롬프팅에 익숙하지 않은 사용자도 쉽게 케어 정보 획득 |

### 1.4 타겟 사용자
- **주 타겟**: 도마뱀 초보 사육자 / 입문 예정자 (20대 초~중반)
- **특징**: 
  - 도마뱀을 키운 지 6개월 이하
  - 커뮤니티에 질문하기 부담스러움
  - AI(ChatGPT 등) 활용에 익숙하지 않음

### 1.5 프로젝트 목적
- 포트폴리오 / 실험 프로젝트
- 유저들의 도마뱀 케어 정보 학습 지원

### 1.6 성공 지표
| 시점 | 지표 |
|------|------|
| 1개월 후 | 팀이 계속 진행하고 싶은 의지가 있는가 |
| 이후 | 가입자 수, 메시지 수 (목표치 추후 설정) |

---

## 2. 기능 정의

### 2.1 MVP 범위 (In Scope)

#### 2.1.1 회원 기능
| 기능 | 상세 |
|------|------|
| 회원가입/로그인 | Google OAuth만 지원 |
| 회원 탈퇴 | 즉시 데이터 삭제 (hard delete) |

#### 2.1.2 도마뱀 프로필
| 항목 | 필수 여부 | 상세 |
|------|----------|------|
| 이름 | 필수 | 텍스트 입력, 최대 20자 |
| 종류 | 필수 | 선택 목록 + "종류를 모르겠어요" 옵션 |
| 나이 | 필수 | 출생년월 선택 (YYYY-MM) |
| 성별 | 선택 | 암컷 / 수컷 / 모름 |
| 프로필 사진 | 선택 | 실사 이미지 (최대 5MB, jpg/png/heic 지원) |
| 성격 | 선택 | 프리셋에서 선택 (소심함/활발함/도도함/느긋함) |

**제한 사항**
- MVP에서는 **유저당 도마뱀 1마리**만 등록 가능
- 추후 다중 도마뱀 지원 시 확장

#### 2.1.3 채팅 기능
| 기능 | 상세 |
|------|------|
| 채팅방 생성 | "새 대화 시작" 버튼으로 수동 생성 |
| 채팅방 제한 | 도마뱀당 **최대 5개**, 초과 시 기존 채팅방 삭제 필요 |
| 메시지 | 텍스트만 지원 (이미지 미지원) |
| 메시지 제한 | 무제한 (MVP) |
| AI 응답 | Gemini API 기반, 도마뱀 페르소나 유지 |

### 2.2 확장 범위 (Out of Scope)
- 다중 도마뱀 관리
- 프로필 사진 업데이트 알림 ("띵동이 모습을 업데이트해주세요!")
- 사진첩 기능
- 사진/영상 분석 기능
- 커뮤니티 기능
- 케어 스케줄링/알림
- 수의사 연결

---

## 3. 사용자 플로우

### 3.1 온보딩 플로우

```
[앱 실행]
    │
    ▼
[로그인 화면]
    │ Google 로그인
    ▼
[도마뱀 프로필 설정]
    │ 이름, 종류, 나이 (필수)
    │ 성별, 사진, 성격 (선택)
    ▼
[채팅 화면 진입]
    │ 시스템 메시지: "띵동이와의 첫 대화에요. 인사 먼저 시작해볼까요?"
    ▼
[대화 시작]
```

### 3.2 채팅 플로우

```
[채팅 목록]
    │
    ├─ [기존 채팅방 선택] → 대화 이어하기
    │
    └─ [새 대화 시작 버튼]
           │
           ├─ 채팅방 5개 미만 → 새 채팅방 생성
           │
           └─ 채팅방 5개 → "채팅방을 더 만들려면 기존 채팅방을 삭제해주세요"
```

### 3.3 첫 채팅 진입 시 UX

| 요소 | 내용 |
|------|------|
| 시스템 메시지 | "띵동이와의 첫 대화에요. 인사 먼저 시작해볼까요?" |
| Input Placeholder | "오늘 기분은 어때? 배고프진 않아?" |
| 추천 질문 (선택) | 버튼 형태로 2~3개 제공 |

---

## 4. 도마뱀 페르소나 설계

### 4.1 성격 프리셋

| 성격 | 코드 | 말투 특징 | 예시 |
|------|------|----------|------|
| 소심함 | `shy` | 말줄임표, 작은 목소리 표현 | "그... 그게..." |
| 활발함 | `active` | 느낌표, 반복, 높은 에너지 | "밥! 밥 줘! 배고파!!" |
| 도도함 | `sassy` | 반말, 관심 없는 척 | "뭐, 먹어줄 수도 있지" |
| 느긋함 | `chill` | 천천히, 여유롭게 | "음~ 뭐 급할 거 있어~" |

### 4.2 종류 목록 (하드코딩)

| 코드 | 한글명 | 영문명 |
|------|--------|--------|
| `crested_gecko` | 크레스티드 게코 | Crested Gecko |
| `leopard_gecko` | 레오파드 게코 | Leopard Gecko |
| `bearded_dragon` | 비어디 드래곤 | Bearded Dragon |
| `blue_tongue_skink` | 블루텅 스킨크 | Blue Tongue Skink |
| `corn_snake` | 콘스네이크 | Corn Snake |
| `ball_python` | 볼파이썬 | Ball Python |
| `unknown` | 종류를 모르겠어요 | Unknown |

> 💡 `unknown` 선택 시 AI 프롬프트에서 종별 케어 정보 생략

### 4.3 AI 응답 원칙

1. **의인화된 1인칭 시점 유지**: "나는 ~", "내가 ~"
2. **케어 정보는 자연스럽게 녹여서 전달**: 딱딱한 정보 나열 X
3. **이모지/팁 박스 활용**: 정보성 메시지 구분
4. **성격 일관성 유지**: 설정된 성격 프리셋에 맞는 말투

---

## 5. 데이터 정책

### 5.1 메시지 보관 정책

| 항목 | 정책 |
|------|------|
| 보관 기간 | 30일 |
| 30일 후 처리 | 상태를 "삭제됨"으로 변경 (soft delete) |
| 실제 데이터 삭제 | 추후 배치로 처리 (미정) |

### 5.2 채팅방 정책

| 항목 | 정책 |
|------|------|
| 최대 개수 | 도마뱀당 5개 |
| 초과 시 | 기존 채팅방 삭제 후 생성 가능 |
| 채팅방 삭제 | 해당 채팅방의 모든 메시지도 삭제 |

### 5.3 회원 탈퇴 정책

| 항목 | 정책 |
|------|------|
| 탈퇴 방식 | 즉시 삭제 (hard delete) |
| 삭제 범위 | 유저 정보, 도마뱀 프로필, 모든 채팅방 및 메시지 |
| 복구 | 불가능 |

### 5.4 이미지 정책

| 항목 | 정책 |
|------|------|
| 저장소 | AWS S3 |
| 최대 용량 | 5MB |
| 지원 포맷 | jpg, jpeg, png, heic |
| 처리 | 업로드 시 리사이징/압축 (추후 정의) |

---

## 6. AI 컨텍스트 관리

### 6.1 장기 기억 (System Prompt)

**목적**: 도마뱀과의 관계, 누적된 대화 맥락을 기억

**업데이트 방식**:
- 매일 새벽 배치 작업 (AWS Lambda)
- 전날 대화 내용을 LLM으로 요약
- 요약 결과를 `lizard_context` 테이블에 저장
- 다음 대화 시 System Prompt에 포함

**저장 내용 예시**:
```json
{
  "summary": "주인은 회사원이고, 최근 출장이 잦다고 했음. 망고는 탈피를 잘 안 해서 걱정하고 있음.",
  "key_facts": {
    "owner_facts": ["회사원", "출장 잦음"],
    "lizard_events": ["1월 5일 탈피 완료"],
    "health_notes": ["식욕 양호"]
  }
}
```

### 6.2 단기 기억 (Context Window)

**목적**: 현재 대화의 흐름 유지

**방식**:
- 현재 채팅방의 **최근 30개 메시지**만 API에 전송
- 오래된 메시지는 DB에만 보관

### 6.3 API 호출 구조

```
┌─────────────────────────────────────────────┐
│              Gemini API Request             │
├─────────────────────────────────────────────┤
│                                             │
│  System Prompt                              │
│  ├── 기본 페르소나 (종, 이름, 나이, 성격)    │
│  ├── 종별 케어 정보                          │
│  ├── lizard_context.summary (장기 기억)     │
│  └── 오늘 날짜                               │
│                                             │
│  Messages                                   │
│  └── 현재 chat의 최근 30개 메시지            │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 7. 비즈니스 규칙

### 7.1 제한 사항 요약

| 항목 | 제한 |
|------|------|
| 유저당 도마뱀 수 | 1마리 |
| 도마뱀당 채팅방 수 | 5개 |
| 일일 메시지 수 | 무제한 |
| 프로필 이미지 용량 | 5MB |
| 메시지 보관 기간 | 30일 |

### 7.2 에러 케이스

| 상황 | 처리 |
|------|------|
| 채팅방 5개 초과 생성 시도 | "채팅방은 최대 5개까지 만들 수 있어요. 기존 채팅방을 삭제해주세요." |
| 도마뱀 추가 등록 시도 | "지금은 도마뱀 한 마리만 등록할 수 있어요." |
| 이미지 5MB 초과 | "이미지 크기가 너무 커요. 5MB 이하로 줄여주세요." |
| 지원하지 않는 이미지 포맷 | "jpg, png, heic 형식만 지원해요." |

---

## 8. 플랫폼 정책

### 8.1 지원 플랫폼
- iOS (App Store)
- Android (Google Play)

### 8.2 연령 제한
- 전체 이용가 (연령 제한 없음)

### 8.3 인증 방식
- Google OAuth 2.0만 지원

---

## 9. 브랜드 톤앤매너

### 9.1 참고 무드
- **썸원 (Someone)**: 캐릭터성 있는 따뜻한 커뮤니케이션
- 토스 스타일의 깔끔/미니멀보다는 **직접 대화하는 느낌**

### 9.2 핵심 키워드
- 관계성
- 라포 (Rapport)
- 따뜻함
- 친근함

### 9.3 UI 방향
| 요소 | 방향 |
|------|------|
| 전체 톤 | 귀엽고 아기자기함 |
| 도마뱀 캐릭터 | 일러스트 (아바타 등) |
| 프로필 사진 | 실사 이미지 사용 |
| 채팅 UI | 정보성 메시지 구분 (팁 박스, 경고 등) |

---

## 10. 기술 스택 요약

| 영역 | 기술 |
|------|------|
| Frontend | React Native (Expo) |
| Backend | Supabase (PostgreSQL + Auth) |
| AI | Google Gemini API |
| 이미지 저장 | AWS S3 |
| 배치 작업 | AWS Lambda |
| 배포 | iOS App Store, Google Play |

---

## 부록 A: 용어 정의

| 용어 | 정의 |
|------|------|
| 도마뱀 프로필 | 유저가 등록한 도마뱀의 정보 (이름, 종류, 나이 등) |
| 채팅방 | 도마뱀과의 대화 세션 단위 |
| 페르소나 | AI가 연기하는 도마뱀 캐릭터의 성격과 말투 |
| 장기 기억 | 배치로 생성되는 누적 대화 요약 (lizard_context) |
| 단기 기억 | API 호출 시 포함되는 최근 메시지들 |

---

## 부록 B: 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| v1.0 | 2025-01-09 | 최초 작성 | 명근 |
